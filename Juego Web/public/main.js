const data = {
	frames: {
	  "walk00001.png": {
		frame: {
		  x: 1,
		  y: 121,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "walk00002.png": {
		frame: {
		  x: 39,
		  y: 121,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "walk00003.png": {
		frame: {
		  x: 77,
		  y: 121,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "walk00004.png": {
		frame: {
		  x: 115,
		  y: 121,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "walk00005.png": {
		frame: {
		  x: 153,
		  y: 1,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "walk00006.png": {
		frame: {
		  x: 171,
		  y: 39,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "walk00007.png": {
		frame: {
		  x: 171,
		  y: 77,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "walk00008.png": {
		frame: {
		  x: 171,
		  y: 115,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "back00001.png": {
		frame: {
		  x: 1,
		  y: 1,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "back00002.png": {
		frame: {
		  x: 39,
		  y: 1,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "back00003.png": {
		frame: {
		  x: 77,
		  y: 1,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "back00004.png": {
		frame: {
		  x: 115,
		  y: 1,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "back00005.png": {
		frame: {
		  x: 1,
		  y: 39,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "back00006.png": {
		frame: {
		  x: 39,
		  y: 39,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "back00007.png": {
		frame: {
		  x: 77,
		  y: 39,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "idle1.png": {
		frame: {
		  x: 115,
		  y: 39,
		  w: 26,
		  h: 39
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 26,
		  h: 39
		},
		sourceSize: {
		  w: 26,
		  h: 39
		}
	  },
	  "idle2.png": {
		frame: {
		  x: 143,
		  y: 39,
		  w: 26,
		  h: 39
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 26,
		  h: 39
		},
		sourceSize: {
		  w: 26,
		  h: 39
		}
	  },
	  "idle200001.png": {
		frame: {
		  x: 1,
		  y: 80,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "idle200002.png": {
		frame: {
		  x: 39,
		  y: 80,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "idle200003.png": {
		frame: {
		  x: 77,
		  y: 80,
		  w: 36,
		  h: 36
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 36,
		  h: 36
		},
		sourceSize: {
		  w: 36,
		  h: 36
		}
	  },
	  "idle3.png": {
		frame: {
		  x: 115,
		  y: 80,
		  w: 26,
		  h: 39
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 26,
		  h: 39
		},
		sourceSize: {
		  w: 26,
		  h: 39
		}
	  },
	  "idle4.png": {
		frame: {
		  x: 143,
		  y: 80,
		  w: 26,
		  h: 39
		},
		rotated: false,
		trimmed: false,
		spriteSourceSize: {
		  x: 0,
		  y: 0,
		  w: 26,
		  h: 39
		},
		sourceSize: {
		  w: 26,
		  h: 39
		}
	  }
	},
	meta: {
	 
	  version: "1.0",
	  image: "mario.png",
	  format: "RGBA8888",
	  size: {
		w: 208,
		h: 158
	  },
	  scale: "1"
	}
  };
  
  const canvas = document.querySelector('canvas');
  canvas.width = 1350;
  canvas.height = 660 ;
  document.body.appendChild(canvas);
  const ctx = canvas.getContext("2d");
  //canvas.style.backgroundImage = "url('bosuqe.png')";
  // ctx.fillRect(0, 0, canvas.width, canvas.height)
  
  let mario;
  let frames = 0;
  
  class Sprite {
	constructor({ animations = [], data }) {
	  this.animations = animations;
	  this.animation = "walk";
	  this.frame = {};
	  this.frameIndex = -1;
	  this.data = data;
	}
  
	advance() {
	  if (frames % 8 === 0) {
		this.frameNames = this.animations[this.animation].frames;
  
		if (this.frameIndex + 1 >= this.frameNames.length) {
		  this.frameIndex = 0;
		} else {
		  this.frameIndex++;
		}
		this.frame = this.data.frames[this.frameNames[this.frameIndex]].frame;
	  }
	}
  }
  
  class Character extends Sprite {
	constructor(imageURL, spriteObject, x, y, w, h) {
	  super(spriteObject);
	  this.x = x || 50;
	  this.y = y || 500;
	  this.w = w || 75;
	  this.h = h || 75;
	  this.image = new Image();
	  this.image.src = imageURL;
	}
  
	draw() {
	  this.advance();
	  ctx.drawImage(
		this.image,
		this.frame.x,
		this.frame.y,
		this.frame.w,
		this.frame.h,
		this.x,
		this.y,
		this.w,
		this.h
	  );
	}
  }
  
  //mario = new Character('./idle_walk.png')
  
  //loop
  const update = () => {
	frames++;
	ctx.clearRect(0, 0, canvas.width, canvas.height);
	// draw mario here
	//canvas.style.backgroundImage = "url('bosuqe.png')";
	
	mario.draw();
	requestAnimationFrame(update);
	
  };
  
  mario = new Character("mario.png", {
	data,
	animations: {
	  walk: {
		name: "walk",
		frames: [
		  "walk00001.png",
		  "walk00002.png",
		  "walk00003.png",
		  "walk00004.png",
		  "walk00005.png",
		  "walk00006.png",
		  "walk00007.png",
		  "walk00008.png"
		]
	  },
	  idle2: {
		name: "idle2",
		frames: ["idle200001.png", "idle200002.png", "idle200003.png"]
	  },
	  back: {
		name: "back",
		frames: [
		  "back00001.png",
		  "back00002.png",
		  "back00003.png",
		  "back00004.png",
		  "back00005.png",
		  "back00006.png",
		  "back00007.png"
		]
	  }
	}
  });
  update();
  
  addEventListener("keydown", (e) => {
	if (e.key === "ArrowLeft") {
	  mario.animation = "back";
	  if (mario.x >0){
	  	mario.x -=5;
	  }
	} else if (e.key === "ArrowRight") {
	  mario.animation = "walk";
	  if(mario.x < 1300)
	  	mario.x +=5;
		puntuacion += 1
		actualizarPuntuacion(puntuacion)
	}
  });
  addEventListener("keyup", (e) => {
	mario.animation = "idle2";
  });



  //Creamos nuestraas variables de imagenes


//Dibujamos el fondo


var img1 = "url('bosuqe.png')"
var img2 = "url('Fondo.png')"

function cambiarFondo(){
    
    //Cambiamos los fondos cada un segundo
    var fondos = [img1,img2];
    var  index = 0;
    canvas.style.backgroundImage = "url('bosuqe.png')";

    setInterval(function() {
        canvas.style.backgroundImage = fondos[index];
        index = (index + 1);
        if(index == fondos.length){
            index=0;
        }
    }, 2000); 
}
cambiarFondo()


const contendorFlecha = document.querySelector('.flecha-contenedor');
const movIzq = document.querySelector('.flecha.izq');
const movDer = document.querySelector('.flecha.der');


// agrega el evento "click" a cada flecha
movIzq.addEventListener('click', () => flecha("izquierda"));
movDer.addEventListener('click', () => flecha("derecha"));

  
var puntuacion = 0
  // detectar cuando se presiona la tecla
function flecha(direccion) {
if (direccion === "izquierda") {
	mario.animation = "back";
	if (mario.x > 0) {
	mario.x -= 10;
	}
} else if (direccion === "derecha") {
		mario.animation = "walk";
		if (mario.x < 1300) {
		mario.x += 10;
		puntuacion += 1; // aumentar la puntuación cuando Mario se mueve a la izquierda
      actualizarPuntuacion(puntuacion); 
		}
	}
}

  
//Guardo la puntucacion del juego
localStorage.setItem('puntuacion', 0);



// actualiza la puntuación en pantalla
function actualizarPuntuacion(puntuacion) {
	if(puntuacion > 0){
		const puntuacionElemento = document.getElementById("puntuacion") ;
		puntuacionElemento.innerHTML = puntuacion;
	}
  }
  



